#### 浏览器访问URL过程

当我们在浏览器地址栏中输入要访问的URL后，浏览器会分析出URL上的域名，通过DNS服务器会查询出域名映射的IP地址，然后浏览器生成HTTP请求，并通过TCP/IP协议发送给web服务器，web 服务器收到请求后会根据请求生成响应内容。并通过TCP/IP协议返回给客户端。（HTTP协议是TCP/IP协议族的一种）

![](/assets/url.png)

#### TCP/IP协议

TCP/IP协议族是由一个四层协议组成的系统，这四层协议分别为：应用层、传输层、网络层、数据链路层。如下图所示：

![](/assets/tcp.png)

1. 应用层
   > 应用层一般是我们编写的应用程序，其决定了向用户提供的应用服务。应用层可以通过系统调用与传输层进行通信。  
   > 处于应用层的协议非常多，比如FTP（File Transfer Protocol 文件传输协议）、DNS（Domain Name System 域名系统）、HTTP（HyperText Transfer Protocol 超文本传输协议）等。
2. 传输层
   > 传输层通过系统调用向应用层提供处于网络连接中的两台计算机之间的数据传输功能.  
   > 在传输层有两个性质不同的协议：TCP（Transmission Control Protocol 传输控制协议）、UDP（User Data Protocol 用户数据报协议）。
3. 网络层
   > 网络层用来处理在网络上流动的数据包，数据包是网络传输的最小单位。该层规定了通过怎样的路径（传输路线）到达对方计算机，并把数据包传输给对方。
4. 链路层
   > 链路层用来处理连接网络的硬件部分，包括控制操作系统、硬件设备驱动、NIC（Network Interface Card 网络适配器）以及光纤等物理可见部分。硬件上的范畴均在链路层的作用范围之内。

#### DNS查询原理

> 网络通讯大部分是基于TCP/IP的，而TCP/IP是基于IP地址的，所以计算机在网络上进行通讯时只能识别如“192.168.1.1”之类的IP地址，而不认识域名，所以就需要DNS服务器将域名解析成IP地址。

![](/assets/DNS.png)

#### DNS递归和迭代查询的区别

* **主机向本地域名服务器的查询一般都采用递归查询**。如果主机所询问的本地域名服务器不知道被查询域名的IP地址时，**本地域名服务器就以DNS客户的身份向其他根域名服务器继续发送请求报文**（即替该主机继续查询），而不是让该主机自己进行下一步的查询。 
* **本地域名服务器向根域名服务器的查询通常是采用迭代查询。**当根域名服务器接收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地域名服务器下一步应当向哪一个域名服务器进行查询，然后让本地域名服务器进行后续的查询。逐步按照域树的路径向下走直到叶节点，得到了所要解析的域名的IP地址，然后把这个结果返回给发起查询的主机。当然本地域名服务器也可以采用递归查询，这取决于最初的查询请求报文的设置是要采用哪一种查询方式。

![](/assets/search.png)

* 如果本地域名服务器采用迭代查询（图a）：

  * 客户端向本地域名服务器（递归查询）发出解析y.abc.com域名的请求。本地域名服务器查看本地缓存，是否缓存过y.abc.com的域名，如果有直接返回，如果没有执行下一步。
  * 本地域名服务器采用迭代查询，先向根域名服务器查询。
  * 根域名服务器告诉本地域名服务器，下一步应查询的顶级域名服务器dns.com的IP地址。
  * 本地域名服务器向顶级域名服务器dns.com进行查询。
  * 顶级域名服务器dns.com告诉本地域名服务器，下一步应查询的权限域名服务器dns.abc.com的IP地址。
  * 本地域名服务器向权限域名服务器dns.abc.com进行查询。
  * 权限域名服务器dns.abc.com告诉本地域名服务器，所查询的主机的IP地址。
  * 本地域名服务器最后把查询结果告诉m.xyz.com。

    注意：整个查询过程共用到了8个UDP报文。

* 如果本地域名服务器采用递归查询（图b）：

  * 此时，本地域名服务器只需要向根域名服务器查询一次，后面的查询都是其他几个域名服务器之间进行的（步骤3~6）。只是在步骤7，本地域名服务器从根域名服务器得到要查询的IP地址，最后在步骤8，本地域名服务器把查询到的IP地址告诉了客户端，整个查询过程也是使用了8个UDP报文。

#### TCP和UDP区别，UDP使用场景

TCP协议相对于UDP协议的特点是：TCP协议提供面向连接、字节流和可靠的传输。

#### TCP握手和挥手

> 利用TCP协议进行通信的双方必须先建立联系，然后才能开始传输数据。TCP连接是全双工的，也就是说双方的数据读写可以通过一个链接进行。为了确保连接双方可靠性，在双方建立连接时，TCP协议采用了三次握手（Three-way handshaking）策略。

![](/assets/three-way.png)

* 第一次握手：客户端发送带有SYN标志的连接请求报文段，然后进入SYN\_SEND状态，等待服务端的确认。
* 第二次握手：服务端接收到客户端发送的SYN报文段后，需要发送ACK信息对这个SYN报文段进行确认。同时，还要发送自己的SYN请求信息。服务端会将上述的信息放到一个报文段（SYN+ACK报文段）中，一并发送给客户端，此时服务端将会进入SYN\_RECV状态。
* 第三次握手：客户端接收到服务端的SYN+ACK报文段后，会向服务端发送ACK确认报文段，这个报文段发送完毕后，客户端和服务端都会进入ESTABLISHED状态，完成TCP三次握手。

  当三次握手完成后，TCP协议会为连接双方维持连接状态。为了保证数据传输成功，接收端在接收到数据包后必须发送ACK报文作为确认。如果在指定的时间内（这个时间称为重新发送超时时间），发送端没有接收到接收端的ACK报文，那么就会重发超时的数据。

#### HTTPS和HTTP区别

#### http2.0相比1.0好在哪



